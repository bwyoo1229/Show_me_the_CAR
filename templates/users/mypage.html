{% extends 'base.html' %}
{% load get_shop_rating %}
{% block page_name %}
Mypage
{% endblock page_name %}
{% block javascript %}
{% endblock javascript %}

{% block content %}
    <h1>Profile</h1>
    <div class="ranking-ajax">
        {% include "partials/ranking.html" %}
    </div>
    {% comment %} <div class="shops__ranking__wrapper">
        <h3>우수 대리점</h3>
        <!--Please insert liked list of shops-->
        <div class="shops__ranking__container">
            <ul>
                {% for shop in best_shops %}
                    <li><a href="{% url 'shops:shop_detail' id=shop.id %}">{{ shop.name }} 평점: {{shop.average}}</a></li>
                {% endfor %}
            </ul>
            <!--Please insert recent search list of shops-->
        </div>
    </div> {% endcomment %}
    <div>{{ user.username }}님이 찜한 대리점:</div>
    <ul>
        {% for like_shop in like_shops %}
            <li>
                <a href="{% url 'shops:shop_detail' id=like_shop.id %}">{{ like_shop.name }}</a>
                <form id="jsForm{{like_shop.id}}" action="" onsubmit="clickRate(shop_id={{like_shop.id}}, url='{% url 'users:rate_shop_ajax' %}', event)" style="display: none;">
                    {% csrf_token %}
                    <input type="hidden" name="shop_id" value="{{ like_shop.id }}"/>
                    {{ rating_form.as_table }}
                    <button class="jsRateBtn" type="submit">평가하기</button>
                </form>
                <div>내가 준 별점: <span id="jsMyRating{{like_shop.id}}">{{like_shop.ratings.all|get_shop_rating:user}}</span></div>
                <button onclick="clickEditRating(shop_id={{like_shop.id}}, event)" id="jsEditRating{{like_shop.id}}">수정하기</button>
                <button onclick="clickCancelEditRating(shop_id={{like_shop.id}}, event)" id="jsCancelEditRating{{like_shop.id}}" style="display: none;">취소</button>
            </li>
        {% endfor %}
    </ul>


{% endblock %}